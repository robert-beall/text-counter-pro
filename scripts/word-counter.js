class WordCounter{constructor(){this.elements={},this.missingElements=[],this.wordFrequency=[],this.wordFrequencyFiltered=[],["text-input","paste-btn","clear-btn","word-count","avg-word-length","sentence-count","most-common-word","unique-words-count","longest-word","longest-word-length","shortest-word","shortest-word-length","avg-words-per-sentence","paragraph-count","avg-sentences-per-paragraph"].forEach((t=>{const e=document.getElementById(t);e?this.elements[t]=e:this.missingElements.push(t)})),this.missingElements.length>0&&console.warn("Missing DOM elements:",this.missingElements)}async init(){if(!this.isReady())return console.error("Cannot initialize app: missing required DOM elements"),!1;console.log("App initialized successfully");const t=this.getElement("text-input"),e=this.getElement("paste-btn"),n=this.getElement("clear-btn");return t&&(t.value="",t.addEventListener("input",this.handleInput.bind(this))),n&&n.addEventListener("click",this.handleClear.bind(this)),e&&e.addEventListener("click",this.handlePaste.bind(this)),!0}isReady(){return 0===this.missingElements.length&&null!==window.textProcessor}getElement(t){return this.elements[t]?this.elements[t]:(console.warn(`Element with id='${t} not found in DOM`),null)}debounce(t,e){let n;return(...s)=>{clearTimeout(n),n=setTimeout((()=>{t.apply(this,s)}),e)}}handleInput(t){try{const e=t.target.value,n=this.getElement("clear-btn");n&&(e?n.removeAttribute("disabled"):n.setAttribute("disabled",!0)),this.showWordCount(e),this.showSentenceCount(e),this.showAvgWordLength(e),this.showAverageSentenceLength(e),this.showParagraphCount(e),this.showAverageParagraphLength(e),this.expensiveCalculations(e)}catch(t){console.error("Error handling input:",t)}}handleClear(){const t=this.getElement("clear-btn"),e=this.getElement("text-input");e&&(e.value="",e.dispatchEvent(new Event("input",{bubbles:!0}))),t&&t.setAttribute("disabled",!0)}async handlePaste(){const t=this.getElement("paste-btn"),e=this.getElement("text-input");if(t&&e)try{const t=await navigator.clipboard.readText();e.value+=t,e.dispatchEvent(new Event("input",{bubbles:!0}))}catch(t){console.error("Cannot paste user content:",t)}}showWordCount(t){const e=this.getElement("word-count");e&&(e.textContent=textProcessor.getWordCount(t))}showSentenceCount(t){const e=this.getElement("sentence-count");e&&(e.textContent=textProcessor.getSentenceCount(t))}showAvgWordLength(t){const e=this.getElement("avg-word-length");if(e){const n=textProcessor.getAverageCharsPerWord(t);e.textContent=n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}showMostCommonWord(){const t=this.getElement("most-common-word");if(t){const e=this.wordFrequencyFiltered[0]?this.wordFrequencyFiltered[0][0]:this.wordFrequency[0]?this.wordFrequency[0][0]:"N/A";t.textContent=e}}showUniqueWordsCount(t){const e=this.getElement("unique-words-count");e&&(e.textContent=this.wordFrequency.length)}showLongestWord(){const t=this.getElement("longest-word"),e=this.getElement("longest-word-length");if(t&&e){const n=this.wordFrequency.reduce(((t,e)=>e[0].length>t.length?e[0]:t),"");t.textContent=n||"N/A",e.textContent=n.length||0}}showShortestWord(){const t=this.getElement("shortest-word"),e=this.getElement("shortest-word-length");if(t&&e){const n=this.wordFrequency.reduce(((t,e)=>e[0].length<t.length?e[0]:t),this.wordFrequency[0]?this.wordFrequency[0][0]:"");t.textContent=n||"N/A",e.textContent=n.length||0}}showAverageSentenceLength(t){const e=this.getElement("avg-words-per-sentence");if(e){const n=window.textProcessor.getAverageWordsPerSentence(t);e.textContent=n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}showParagraphCount(t){const e=this.getElement("paragraph-count");e&&(e.textContent=window.textProcessor.getParagraphCount(t))}showAverageParagraphLength(t){const e=this.getElement("avg-sentences-per-paragraph");if(e){const n=window.textProcessor.getAverageSentencePerParagraph(t);e.textContent=n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}expensiveCalculations=this.debounce((t=>{this.wordFrequency=textProcessor.calculateWordFrequency(t),this.wordFrequencyFiltered=textProcessor.filterStopWords(this.wordFrequency),this.showMostCommonWord(t),this.showUniqueWordsCount(t),this.showLongestWord(),this.showShortestWord()}),100)}(new WordCounter).init();